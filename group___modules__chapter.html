<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UMPS: Modules</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UMPS
   </div>
   <div id="projectbrief">The University of Utah Seismograph Stations Message Passing System.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group___modules__chapter.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">Modules</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Modules:</div>
<div class="dyncontent">
<div class="center"><img src="group___modules__chapter.png" border="0" usemap="#group______modules____chapter" alt=""/></div>
<map name="group______modules____chapter" id="group______modules____chapter">
<area shape="rect" href="group___modules___module_base_class.html" title="This is a container for the processes that constitute a program." alt="" coords="131,5,277,31"/>
<area shape="rect" title=" " alt="" coords="5,31,83,56"/>
<area shape="rect" href="group___modules___processes_base_class.html" title="Processes are independent components of a program &#45; e.g., heartbeating." alt="" coords="131,55,277,80"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group___modules___module_base_class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___modules___module_base_class.html">Module Base Class</a></td></tr>
<tr class="memdesc:group___modules___module_base_class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a container for the processes that constitute a program. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group___modules___processes_base_class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___modules___processes_base_class.html">Process Base Class</a></td></tr>
<tr class="memdesc:group___modules___processes_base_class"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes are independent components of a program - e.g., heartbeating. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>


<h3><a id="TopicModules"></a>Modules</h3><div class="textblock"><em>Modules</em> are the programs that users will ultimately use. Modules will do things like pick waveforms and associate events. For this reason, a module can be thought of as a standalone program. Modules typically must do multiple things like send status messages and handle commands. A <em>process</em> <em>is</em> the basic building block of a module that actually performs the disparate tasks that constitute a module. <br  />
<br  />
Let's explore in greater detail what a process is and must do<div class="fragment"><div class="line"><span class="preprocessor">#ifndef UMPS_MODULES_PROCESS_HPP</span></div>
<div class="line"><span class="preprocessor">#define UMPS_MODULES_PROCESS_HPP</span></div>
<div class="line"><span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="keyword">namespace </span>UMPS::Modules</div>
<div class="line">{</div>
<div class="line"><span class="keyword">class </span>IProcess</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <a class="code" href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a44ecf5966ebcd3f892aeeafaa4227142">IProcess</a>();</div>
<div class="line"> </div>
<div class="line">    [[nodiscard]] <span class="keyword">virtual</span> std::string <a class="code" href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a297a425844f0b08bd22619272a962791">getName</a>() const noexcept;</div>
<div class="line">    virtual <span class="keywordtype">void</span> operator()();</div>
<div class="line">    virtual <span class="keywordtype">void</span> <a class="code" href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a5a559f59b2bd2260e5ca402688bfbf93">start</a>() = 0;</div>
<div class="line">    virtual <span class="keywordtype">void</span> <a class="code" href="class_u_m_p_s_1_1_modules_1_1_i_process.html#aac51c918dd1f8783b187ab34ed98ffa6">stop</a>() = 0;</div>
<div class="line">    [[nodiscard]] virtual <span class="keywordtype">bool</span> <a class="code" href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a1d9e6923e1a6d5795acdadb4e8fbb28d">isRunning</a>() const noexcept = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_u_m_p_s_1_1_modules_1_1_i_process.html#abd8857353d1e0be7bbbb87cb1936626f">setStopCallback</a>(const std::function&lt;<span class="keywordtype">void</span> ()&gt; &amp;callback);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a69d9d43e05e54b113ccf72d93b53c853">issueStopCommand</a>();</div>
<div class="line"> </div>
<div class="line">    virtual ~<a class="code" href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a44ecf5966ebcd3f892aeeafaa4227142">IProcess</a>();</div>
<div class="line">private:</div>
<div class="line">    class IProcessImpl;</div>
<div class="line">    std::unique_ptr&lt;IProcessImpl&gt; pImpl;</div>
<div class="line">};</div>
<div class="line">}</div>
<div class="line"><span class="preprocessor">#endif</span></div>
</div><!-- fragment -->A process consists of a few very simple items</p><ul>
<li>A process can be started by either explictly calling <em>start</em> or by using the () operator. In this abstract base class, the default implementation of the operator is to simply call <em>start</em>.</li>
<li>A process can be stopped with <em>stop</em>.</li>
<li>A process must be able to report whether or not it is currently running with <em>isRunning</em>.</li>
<li>A process may be provided a callback so that it can signal the uCommand is requesting a program termination. This is typically leveraged by the process that handles local interaction from uCommand. </li>
</ul>
A potential point of confusion is that a process <em>can</em> <em>be</em> multi-threaded. What this means is that even though a process will likely be started using something of the form std::thread(process), there still may exist a thread-pool within the process's implementation that enables it to achieve its requisite functionality. <br  />
<br  />
Naturally, it would be convenient to collect all of our processes in one container. This the job of the ProcessManager. Specifically, the process manager is a collection of unique processes. At the time of writing, the process manager is very simple. It basically can hold, run, and stop all processes. In time however, we hope it will do really cool things like detect and restart dead processes.<br  />
<br  />
An important process that you should implement is the command process. One extraordinary benefit of embracing messaging is that you can actually run a module in the background with, say, nohup, and then login to that server at a later time and still interact with that module using uCommand. Note, uCommand uses IPC communication and is only usable by the same user on the same machine that is running the program; this is not a limitation of ZeroMQ IPC's implementation but a security consideration. But why stop there? Since the module can interact locally it can also easily be extended to interact with a privileged user on the network. Again, the module could interact with anyone on the network but again, for security reasons and not limitations of ZeroMQ, we require the user issuing commands to remote modules be privileged. <br  />
<br  />
In parting, note that you do not <em>need</em> <em>to</em> write your programs using the Process/ProcessManager paradigm. It exists because I find it convenient and dislike rewriting the same boiler-plate code for common tasks like connecting/querying the uOperator or sending a heartbeat. Indeed, none of the code to implement these tasks is particularly difficult to write. What you may, however, find slightly challenging is organizing your code that you can catch exceptions. </div></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_u_m_p_s_1_1_modules_1_1_i_process_html_abd8857353d1e0be7bbbb87cb1936626f"><div class="ttname"><a href="class_u_m_p_s_1_1_modules_1_1_i_process.html#abd8857353d1e0be7bbbb87cb1936626f">UMPS::Modules::IProcess::setStopCallback</a></div><div class="ttdeci">void setStopCallback(const std::function&lt; void()&gt; &amp;callback)</div><div class="ttdoc">Sets the stop callback if this process needs to stop the program.</div></div>
<div class="ttc" id="aclass_u_m_p_s_1_1_modules_1_1_i_process_html_a69d9d43e05e54b113ccf72d93b53c853"><div class="ttname"><a href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a69d9d43e05e54b113ccf72d93b53c853">UMPS::Modules::IProcess::issueStopCommand</a></div><div class="ttdeci">void issueStopCommand()</div><div class="ttdoc">Issues the stop command by calling the callback.</div></div>
<div class="ttc" id="aclass_u_m_p_s_1_1_modules_1_1_i_process_html_a44ecf5966ebcd3f892aeeafaa4227142"><div class="ttname"><a href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a44ecf5966ebcd3f892aeeafaa4227142">UMPS::Modules::IProcess::IProcess</a></div><div class="ttdeci">IProcess()</div><div class="ttdoc">Constructor.</div></div>
<div class="ttc" id="aclass_u_m_p_s_1_1_modules_1_1_i_process_html_a1d9e6923e1a6d5795acdadb4e8fbb28d"><div class="ttname"><a href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a1d9e6923e1a6d5795acdadb4e8fbb28d">UMPS::Modules::IProcess::isRunning</a></div><div class="ttdeci">virtual bool isRunning() const noexcept=0</div></div>
<div class="ttc" id="aclass_u_m_p_s_1_1_modules_1_1_i_process_html_aac51c918dd1f8783b187ab34ed98ffa6"><div class="ttname"><a href="class_u_m_p_s_1_1_modules_1_1_i_process.html#aac51c918dd1f8783b187ab34ed98ffa6">UMPS::Modules::IProcess::stop</a></div><div class="ttdeci">virtual void stop()=0</div><div class="ttdoc">Stops the process.</div></div>
<div class="ttc" id="aclass_u_m_p_s_1_1_modules_1_1_i_process_html_a5a559f59b2bd2260e5ca402688bfbf93"><div class="ttname"><a href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a5a559f59b2bd2260e5ca402688bfbf93">UMPS::Modules::IProcess::start</a></div><div class="ttdeci">virtual void start()=0</div><div class="ttdoc">Starts the process.</div></div>
<div class="ttc" id="aclass_u_m_p_s_1_1_modules_1_1_i_process_html_a297a425844f0b08bd22619272a962791"><div class="ttname"><a href="class_u_m_p_s_1_1_modules_1_1_i_process.html#a297a425844f0b08bd22619272a962791">UMPS::Modules::IProcess::getName</a></div><div class="ttdeci">virtual std::string getName() const noexcept</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
